

     
      Ever wondered how to display console output in colors? If you've seen the Linux's verbose bootup sequence, you will notice the variety of colors that are used in the console output.  How the hell do you get the same in Windows based console applications? The guys are Redmond haven't left this feature out.  The Windows Platform SDK includes several functions for console manipulation. I will outline some functions that may be used to alter output to the console. The primary function to be used is  SetConsoleTextAttribute()  If you're going to use the SDK directly, this is the definition you'd be interested in:     BOOL SetConsoleTextAttribute( HANDLE hConsoleOutput, WORD wAttributes )    Unfortunately, in the managed world, no APIs are directly available. They will have to be invoked via P/Invoke. There is an posting on CodeProject by Philip Fitzsimons for this purpose. ( urlLink here )  There is one missing feature in the source he provides: Many of us customize our consoles to suit our purpose; many a times changing our console foreground and background colors. In his call to  SetForeGroundColor()  which he uses to reset the console, he just sets the foreground color of the console to Grey.  A better way would be to convert his entire class to an instance and convert all his methods into instance methods rather than static methods. In the constructor, you could use an Interop call to:     [DllImport("kernel32.dll")] static extern bool GetConsoleScreenBufferInfo(IntPtr hConsoleOutput, out CONSOLE_SCREEN_BUFFER_INFO lpConsoleScreenBufferInfo);     Of course, you would need to write the C# equivalent for the structure  CONSOLE_SCREEN_BUFFER_INFO . The structure contains the character attributes for the console. Store these within your instance, and just revert to the same character attributes with a call to  SetConsoleTextAttribute()  after doing your custom formatting.  There is a managed C++ sample to do the same  urlLink here   There is still nothing as good as a console program to do some tasks!
     
    
